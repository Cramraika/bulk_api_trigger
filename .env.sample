# ===================================
# ðŸš€ BULK API TRIGGER CONFIGURATION
# ===================================

# --- Deployment Settings ---
DEPLOYMENT_MODE=true
KEEP_ALIVE=true
JOB_NAME=
HEALTH_PORT=8000
HEALTH_CHECK_ENABLED=true
METRICS_ENABLED=true

# --- Webhook API Settings ---
WEBHOOK_AUTH_TOKEN=                    # Optional Bearer token for API authentication
WEBHOOK_RATE_LIMIT=60                  # Max webhook triggers per minute per IP

# --- Resume Functionality ---
RESUME_ENABLED=true
RESUME_CHECKPOINT_INTERVAL=100         # Save progress every N processed rows
RESUME_MARKER_PATH=/app/data/reports   # Directory for resume markers
RESUME_MAX_AGE_DAYS=7                  # Max age of resume markers before ignored

# --- Watchdog File Monitoring ---
WATCHDOG_ENABLED=true
WATCH_PATHS=/app/data/csv
AUTO_PROCESS=true
DEBOUNCE_DELAY=3.0
PROCESSING_WORKERS=1
MAX_QUEUE_SIZE=100

# --- CSV Processing ---
CSV_FILE=AUTO                          # Specific file or AUTO for pattern matching
CSV_FILE_PATTERNS=/app/data/csv/*.csv,/app/data/*.csv
CSV_REQUIRED_COLUMNS=webhook_url
CSV_CHUNK_SIZE=1000
SKIP_ROWS=0
MAX_PAYLOAD_SIZE_BYTES=1048576        # 1MB max payload size

# --- Rate Limiting (seconds between requests) ---
MAX_WORKERS=3                          # Concurrent worker threads
BASE_RATE_LIMIT=3.0                    # Base delay between requests
STARTING_RATE_LIMIT=3.0                # Initial delay
MAX_RATE_LIMIT=10.0                    # Max delay when errors occur
WINDOW_SIZE=20                         # Requests window for rate adjustment
ERROR_THRESHOLD=0.3                    # Error rate threshold for slowdown
GLOBAL_MAX_REQUESTS=0                  # Global semaphore limit (0=unlimited)

# --- HTTP Request Settings ---
MAX_RETRIES=3
RETRY_DELAY=1.0
REQUEST_TIMEOUT=30
REQUEST_CONNECT_TIMEOUT=0              # Optional connect timeout (0=use REQUEST_TIMEOUT)
SEMAPHORE_ACQUIRE_TIMEOUT=30
HTTP_POOL_MAXSIZE=16
HTTP_USER_AGENT=BulkAPITrigger/1.0
MAX_HEADER_SIZE=10000
MAX_HEADER_COUNT=50

# --- Database ---
DATABASE_ENABLED=true
DATABASE_PATH=/app/data/webhook_results.db
DATABASE_BACKUP_ENABLED=true
DATABASE_BACKUP_INTERVAL_HOURS=24

# --- File Management ---
ARCHIVE_PROCESSED=true
ARCHIVE_ON_VALIDATION_FAILURE=true
ARCHIVE_PATH=/app/data/csv/processed
DUPLICATES_PATH=/app/data/csv/duplicates
REJECTED_PATH=/app/data/csv/rejected

# --- Logging & Reports ---
LOG_LEVEL=INFO
MAX_LOG_SIZE_MB=100
REPORT_PATH=/app/data/reports
REPORT_KEEP=200
FORCE_TQDM=0                           # Force progress bar in non-TTY
PROGRESS_EVERY_N=50                    # Log progress every N requests

# --- Slack Notifications ---
SLACK_NOTIFICATIONS=false
SLACK_WEBHOOK_URL=
SLACK_NOTIFY_COMPLETION=true
SLACK_NOTIFY_FILE_DETECTED=true
SLACK_NOTIFY_PROGRESS=false
SLACK_PROGRESS_EVERY_N=25              # Progress update frequency (%)
SLACK_PROGRESS_FIRST_AT_N=10           # First progress update at N%
SLACK_PROGRESS_MIN_PCT=5               # Minimum progress % to start notifications
SLACK_PROGRESS_URGENCY=auto            # auto|low|normal|high|critical

# --- Email Notifications ---
EMAIL_NOTIFICATIONS=false
EMAIL_SMTP_SERVER=smtp.gmail.com
EMAIL_SMTP_PORT=587
EMAIL_USERNAME=
EMAIL_PASSWORD=
EMAIL_FROM=
EMAIL_RECIPIENTS=                      # Comma-separated email addresses
EMAIL_NOTIFY_COMPLETION=true
EMAIL_NOTIFY_FILE_DETECTED=false

# --- Testing & Debugging ---
SEND_TEST_NOTIFICATIONS_ON_STARTUP=false